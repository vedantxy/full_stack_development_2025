
# MongoDB Assignment Workbook

**Dataset:** `db.companies` (20 SDE1 hiring companies)

---

## Section A. CRUD Basics (40 Queries)

1. Insert a new company document for "Tesla" in Bangalore with base = 29 LPA.
2. Insert multiple new companies at once (add "Stripe" and "Coinbase").
3. Find all companies.
4. Find one company (`findOne()`) in Bangalore.
5. Find companies offering base > 30 LPA.
6. Find companies in Hyderabad.
7. Find companies requiring CGPA >= 8.0.
8. Find companies that list "System Design" in skills.
9. Find companies that offer "Relocation".
10. Find companies with stock >= 15 LPA.
11. Find companies with at least 4 interview rounds.
12. Find companies with headcount > 5000.
13. Insert a company with only `name` and `location`.
14. Update Amazon’s bonus to 6.
15. Update all companies in Hyderabad to add benefit = "Free Snacks".
16. Add skill "Python" to Google’s criteria.
17. Remove "Gym" from Microsoft benefits.
18. Replace entire salaryBand for Netflix.
19. Delete company "Infosys".
20. Delete all companies with base < 10.
21. Use `$set` to add a new field `isTopTier: true` for Google.
22. Use `$inc` to increase Amazon’s stock by 2.
23. Use `$rename` to rename field `headcount` → `employeeCount`.
24. Use `$unset` to remove "bonus" from salaryBand.
25. Insert 5 dummy companies with minimal fields.
26. Delete all dummy companies.
27. Find all companies, project only `name` and `salaryBand`.
28. Find all companies, exclude `_id`.
29. Find only `name` and `benefits` for Microsoft.
30. Count all companies in Bangalore.
31. Count all companies requiring CGPA >= 7.0.
32. Get distinct locations.
33. Get distinct benefits offered.
34. Check if any company offers stock = 20.
35. Insert company with nested object `{ perks: { transport: true } }`.
36. Push new round `{ round: 5, type: "CTO Interview" }` to Meta.
37. Pull "HR" round out of Amazon’s rounds.
38. Add "Health Insurance" only if not present in Swiggy benefits.
39. Increase base salary by 2 for all companies in Bangalore.
40. Delete all companies in "Delhi" (if any exist).

---

## Section B. Advanced Queries (60 Queries)

41. Find companies with base between 25–35.
42. Find companies where stock < 10.
43. Find companies with bonus > 5 AND stock > 10.
44. Find companies with base >= 30 OR stock >= 12.
45. Find companies NOT requiring "OS".
46. Find companies requiring at least one skill from \["Java", "C++"].
47. Find companies requiring BOTH "DSA" and "System Design".
48. Find companies not offering WFH.
49. Find companies with > 3 benefits.
50. Find companies with exactly 4 interview rounds.
51. Find companies where employeeCount > 2000.
52. Find companies offering salaries in multiples of 5.
53. Find companies where CGPA is in \[6.5, 7.0, 7.5].
54. Find companies not in Bangalore.
55. Use regex to find skills ending in "Design".
56. Use regex to find companies starting with "A".
57. Case-insensitive search for "amazon".
58. Find companies where `salaryBand.stock` exists.
59. Find companies where `perks` does NOT exist.
60. Find companies where `salaryBand.base` is of type number.
61. Sort companies by base ascending.
62. Sort companies by base descending.
63. Sort by bonus, then stock.
64. Limit results to top 5 highest base salary.
65. Skip first 5 and return next 5.
66. Find company with maximum base salary.
67. Find company with minimum CGPA requirement.
68. Return first 3 companies alphabetically by name.
69. Find companies with at least one "Technical" interview round.
70. Find companies where round 2 is "System Design".
71. Find companies where interviewRounds length > 3.
72. Find companies where second benefit = "WFH".
73. Use `$all` to find companies requiring \["DSA", "Java"].
74. Use `$elemMatch` for base > 25 and stock > 5 in salaryBand.
75. Use `$in` for location in \["Hyderabad", "Bangalore"].
76. Use `$nin` for location not in \["Mumbai", "Pune"].
77. Find company closest to base = 30.
78. Use `$not` to exclude base < 20.
79. Use `$expr` to find companies where bonus < base/10.
80. Use `$size` to find companies with exactly 2 benefits.
81. Project new field `totalComp = base+bonus+stock`.
82. Find companies where totalComp > 45.
83. Sort companies by totalComp descending.
84. Use `$mul` to multiply stock by 2.
85. Use `$max` to ensure bonus >= 5.
86. Use `$min` to cap base salary at 35.
87. Use `$addToSet` to ensure unique benefit "WFH".
88. Use arrayFilters to update only 3rd round = "Tech Screen".
89. Update multiple docs with `$currentDate` for `lastUpdated`.
90. Delete companies without benefits field.
91. Upsert: Update "Tesla" if exists, insert if not.
92. Find all companies but exclude "salaryBand".
93. Project only name and computed field `doubleStock = stock*2`.
94. Match companies whose name length = 6 using `$expr`.
95. Query with `$mod`: base % 2 = 0.
96. Query with `$where`: headcount > 2000.
97. Query using `$text` after creating text index on `skills`.
98. Use collation for case-insensitive sort by name.
99. Query with `$type: "array"` on benefits.
100. Find companies where "Free Meals" is one of the benefits.

---

## Section C. Aggregations (100 Queries)

101. `$match` companies with base >= 30.
102. `$project` name + base only.
103. `$project` new field `totalComp`.
104. `$group` avg base per location.
105. `$group` max base per company.
106. `$group` min CGPA per location.
107. `$group` total headcount by location.
108. `$sort` by base.
109. `$sort` by totalComp.
110. `$limit` to 3 top-paying companies.
111. `$skip` first 5.
112. `$count` companies in Bangalore.
113. `$unwind` benefits.
114. `$group` count of each unique benefit.
115. `$unwind` interviewRounds.
116. `$group` by interview type, count frequency.
117. `$lookup` join with `candidates` collection.
118. `$facet` pipeline → salaries vs benefits.
119. `$bucket` base salaries into \[0–10, 11–20, 21–30, 31–40].
120. `$bucketAuto` for salaryBand.base into 4 buckets.
121. `$match` companies offering "Stock Options".
122. `$project` to hide headcount.
123. `$project` boolean field `isHighPaying: base > 30`.
124. `$group` avg stock by location.
125. `$group` totalComp sum per company.
126. `$sort` by CGPA requirement descending.
127. `$match` + `$group` → avg salary only in Hyderabad.
128. `$lookup` join Student–Course schema.
129. `$lookup` join Post–User schema.
130. `$replaceRoot` to flatten salaryBand.
131. `$set` new field `salaryBand.total`.
132. `$addFields` skillCount = `$size: skills`.
133. `$match` + `$project` → only companies with > 2 skills.
134. `$group` → number of companies per skill.
135. `$unwind` skills.
136. `$group` skill popularity across companies.
137. `$sort` skill popularity descending.
138. `$lookup` join companies with interview database.
139. `$cond` → tag "premium" if base > 30.
140. `$ifNull` → set bonus = 0 if null.
141. `$switch` → assign rating based on base salary ranges.
142. `$regexMatch` to filter names ending in "s".
143. `$merge` results into `salaryAnalysis` collection.
144. `$out` write salary analysis into `analysis` collection.
145. `$group` → total base per benefit.
146. `$group` → count companies with WFH.
147. `$sort` → companies with most benefits.
148. `$unwind` + `$group` → average CGPA per skill.
149. `$group` → avg interview rounds per location.
150. `$count` → number of interview types across dataset.
151. Group by `location` to get **total companies** and **average base salary** per location.
152. Find the **top 3 locations** by **average total compensation** (`base+bonus+stock`).
153. List the **top 5 most demanded skills** across companies (count frequency).
154. Compute, per location, the **average of (stock + bonus)**.
155. Rank companies by **total compensation** and return the **top 5**.
156. Count how many companies **require “System Design”**.
157. For each **skill**, compute **average CGPA requirement**.
158. Show companies with **benefitCount > 2**, sorted by **benefitCount** then **base**.
159. For each company, show **name** and **total number of interview rounds**.
160. Find the **most common interview round type** overall.
161. Bucket companies by **base salary** into `<=10`, `11–20`, `21–30`, `>30` and count.
162. Split into two facets: companies with **CGPA ≥ 8** vs **CGPA < 8** (return counts).
163. For each location, compute **average totalComp** (`base+bonus+stock`).
164. Approximate **median base salary** using `$bucketAuto` (2 buckets).
165. Compute **average base salary per benefit** (unwind benefits).
166. Show **skill frequency by location** (location+skill pair counts).
167. List companies having **at least one “OA”** round (just names).
168. Return **global min and max** of `salaryBand.base`.
169. **Top 3 companies** by **number of skills** in `hiringCriteria`.
170. List **all unique interview round types** (distinct).
171. Find companies where **totalComp > average totalComp** across dataset.
172. For each company, project **name** and **benefitCount**.
173. List **top 5 benefits** by **popularity**.
174. Count companies that offer **both “WFH” and “Stock Options”**.
175. For each **location**, return the **highest base** and the **company name** that has it.
176. For each **location**, return **lowest CGPA** and the **company** with that value.
177. For each company, project **skills concatenated** into a single **string**.
178. Group by **experience requirement** and **count** companies per group.
179. Compute **average number of interview rounds** across companies.
180. Return **top 3 companies by stock** value.
181. Return **top 3 companies by bonus** value.
182. For each company, compute **stock\:base ratio** and project it.
183. For each company, project **cashComp = base + bonus**.
184. Bucket companies by **skillCount** into ranges `[0–1]`, `[2–3]`, `[4+]`.
185. Count companies that **list “DSA”** in their skills (simple frequency).
186. Group by **roundsCount** and compute **avg base** for each bucket.
187. For each **skill**, find the **company with the highest stock**.
188. For each company, project **(base − stock)** as `diff`.
189. Sort companies by **benefitCount** then **base** descending; return names and counts.
190. Find the **company with the maximum number of interview rounds**.
191. Group by **location** to get a **count of companies** per location.
192. Compute **average stock** grouped by **location**.
193. Match companies that require **both “Java” and “System Design”** (count them).
194. Group by **experience** and compute **average base** per experience level.
195. Return **top 3 companies by employeeCount**.
196. Compute **total employeeCount** across all companies.
197. Sort companies by **CGPA requirement** then by **base** (both descending).
198. Find the **location** with the **highest average total compensation**.
199. For each **location**, compute the **number of distinct skills** present (skill diversity).
200. Build a **single-facet dashboard** returning:
     \- `totalCompanies`
     \- `avgBase`
     \- `mostCommonSkill`
     \- `mostCommonBenefit`
     \- `highestPayingCompany` (by totalComp)

---

## Section D. Indexing & Performance (40 Queries)

201. Create index on `name`.
202. Create compound index on `location + salaryBand.base`.
203. Create text index on `skills`.
204. Use `$text` search "Java".
205. Create index on `salaryBand.stock`.
206. Use `.explain("executionStats")` on a query.
207. Drop index on `name`.
208. Create unique index on `name`.
209. Create sparse index on `benefits`.
210. Create partial index for base > 25.
211. Query with text index sorted by score.
212. Create collation for case-insensitive `name`.
213. Compound index on \[location, headcount].
214. Covered query with projection.
215. Multi-key index for `benefits` array.
216. Test performance with vs without index.
217. Use `.hint()` to force index.
218. Wildcard index for dynamic keys.
219. TTL index for `postedAt`.
220. Hashed index on `name` (sharding).
221. Background index creation.
222. Drop all indexes.
223. Recreate index on CGPA.
224. Unique + partial index on location = Bangalore.
225. Explain plan for range query.
226. Create text + compound index.
227. Covered query example for base + stock.
228. Query sorted by compound index fields.
229. Explain stats for regex query.
230. Paginate using index on base.
231. Paginate using skip-limit.
232. Compare pagination performance.
233. Test query with array index.
234. Index nested field `hiringCriteria.cgpa`.
235. Drop index on benefits.
236. Rebuild all indexes.
237. Analyze query cache.
238. Use `.hint()` wrong index and observe.
239. Index with case-insensitive collation.
240. Multi-field partial index.

---

## Section E. Bonus Challenges (40 Queries)

241. Find **top 5 highest-paying companies** that also offer WFH.
242. Find companies with **avg salary > 30 LPA** grouped by location.
243. Find **companies requiring DSA** and sort by totalComp.
244. Find **companies where base > avg(base)**.
245. Bucket companies by **CGPA requirement**.
246. Find **most common skill** required across companies.
247. Find **most common benefit** offered.
248. Rank companies by **salary in each location**.
249. Dashboard pipeline: `{ location, avgSalary, topCompany }`.
250. Count **average interview rounds** per company.
251. Find companies with both "Stock Options" and "Relocation".
252. Find total employees across all Bangalore companies.
253. Find company with **highest stock** in salary.
254. Find company with **lowest bonus**.
255. Find **all skills required across all companies**.
256. Count **unique interview types** across dataset.
257. Create a leaderboard of **companies by headcount**.
258. Find **companies offering device discounts**.
259. Find **companies where benefits > skills count**.
260. Nested populate simulation (companies ↔ candidates).
261. Find **average stock by location**.
262. Find **companies where salary > 1.5x avg salary**.
263. Find **locations with more than 3 companies**.
264. Find **companies in Bangalore with WFH and >25 base**.
265. Find **companies that don’t require CGPA >= 7.5**.
266. Find **top 3 companies by interview rounds count**.
267. Find **distribution of salaries into 5 bands**.
268. Build a **search API** style query with `$text` + `$meta`.
269. Count **companies by experience requirement**.
270. Find **companies offering both Free Meals and Free Lunch**.
271. Find **location with highest avg stock**.
272. Rank **skills by frequency** across dataset.
273. Find **company offering stock + base > 40**.
274. Find **companies requiring Java but not System Design**.
275. Find **companies where interview type = "Culture Fit"**.
276. Find **companies where base > stock+bonus**.
277. Find **company with maximum total compensation**.
278. Build a pipeline to compute **salary percentiles**.
279. Group companies by **benefit count**.
280. Output final dashboard:

```
{
  totalCompanies,
  avgBase,
  mostCommonSkill,
  mostCommonBenefit,
  highestPayingCompany
}
```

---
